<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bow Game - Custom Shape</title>
<style>
    body {
        margin: 0;
        background: #fff;
        overflow: hidden;
    }
    canvas {
        display: block;
        background: #fff;
    }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const bow = {
    x: 150,
    y: canvas.height / 2,
    size: 150,
    height: 200 // chiều cao cung
};

let pulling = false;
let mouse = { x: bow.x, y: bow.y };
let arrow = {
    x: bow.x,
    y: bow.y,
    vx: 0,
    vy: 0,
    flying: false,
};

function drawBowAndString() {
    // Draw the bow shape like a ')'
    ctx.beginPath();
    ctx.lineWidth = 8;
    ctx.strokeStyle = 'red'; // Cung màu đỏ

    // Move to top
    ctx.moveTo(bow.x, bow.y - bow.height/2);
    // Curve to bottom
    ctx.quadraticCurveTo(
        bow.x + bow.size, 
        bow.y, 
        bow.x, 
        bow.y + bow.height/2
    );
    ctx.stroke();

    // String (black)
    ctx.beginPath();
    ctx.moveTo(bow.x, bow.y - bow.height/2);
    ctx.lineTo(arrow.x, arrow.y);
    ctx.lineTo(bow.x, bow.y + bow.height/2);
    ctx.lineWidth = 2;
    ctx.strokeStyle = 'black'; // Dây màu đen
    ctx.stroke();
}

function drawArrow() {
    ctx.beginPath();
    ctx.moveTo(arrow.x, arrow.y);
    ctx.lineTo(arrow.x + 100, arrow.y); // 🏹 Tên dài 100px
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 4;
    ctx.stroke();

    // Arrowhead
    ctx.beginPath();
    ctx.moveTo(arrow.x + 100, arrow.y); // Đầu mũi tên cũng phải dịch theo
    ctx.lineTo(arrow.x + 95, arrow.y - 5);
    ctx.lineTo(arrow.x + 95, arrow.y + 5);
    ctx.closePath();
    ctx.fillStyle = 'black';
    ctx.fill();
}

function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (arrow.flying) {
        arrow.x += arrow.vx;
        arrow.y += arrow.vy;
    } else if (pulling) {
        arrow.x = mouse.x;
        arrow.y = mouse.y;
    } else {
        arrow.x = bow.x;
        arrow.y = bow.y;
    }

    drawBowAndString();
    drawArrow();

    requestAnimationFrame(update);
}

canvas.addEventListener('mousedown', (e) => {
    pulling = true;
    mouse.x = e.clientX;
    mouse.y = e.clientY;
});

canvas.addEventListener('mousemove', (e) => {
    if (pulling) {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
    }
});

canvas.addEventListener('mouseup', (e) => {
    if (pulling) {
        pulling = false;
        arrow.flying = true;
        arrow.vx = (arrow.x - bow.x) / 10;
        arrow.vy = (arrow.y - bow.y) / 10;
    }
});

window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    bow.y = canvas.height / 2;
});

update();
</script>
</body>
